<!DOCTYPE html>
<html>
<head>
	<title></title>
	<!-- Latest compiled and minified CSS -->

<link href="https://fonts.googleapis.com/css?family=Acme|Indie+Flower|Shadows+Into+Light" rel="stylesheet">
	
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.5.21/dist/vue.js"></script>
  <script src="/socket.io/socket.io.js"></script>

  <script src="https://api.fondy.eu/static_common/v1/checkout/ipsp.js"></script>

<link rel="stylesheet" href="/style/style.css" type="text/css">
</head>
<body>
<div class="jumbotron text-center">
  <h1>Black Kard</h1>
  <p>Random money wowowo</p> 
</div>


<div class="container">
  <div class="row" v-bind:style="{ display: rowDisplay }">
 <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal2">
 	<b class="balance">23 $</b>  Withdraw money</button>

  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Place a bet</h4>
        </div>
        <div class="modal-body">


			<div>


<script>
	var button = $ipsp.get('button');
	button.setMerchantId(1396424);
	button.setAmount(2, 'USD', true);
	button.setResponseUrl('http://vkontache.ru:3000');
	button.setHost('api.fondy.eu');
	button.addField({
		label: 'ФИО',
		name: 'fio',
		required: true
	});
	button.addField({
		label: 'Описание платежа',
		name: 'description',
		value: 'Оплата за товар',
		readonly: true
	});
</script>
<button onclick="location.href=button.getUrl()">Пожертвовать 2 USD</button>

</div>
        </div>

      </div>
      
    </div>
  </div>

    <div class="modal fade" id="myModal2" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Withdrow money</h4>
        </div>
        <div class="modal-body">

        	<label><input required class="radio-inline" type="radio" name="paymentType" value="vm"> VISA/MasterCard </label>
        	<br>  
			<label><input required class="radio-inline" type="radio" name="paymentType" value="wm"> WebMoney </label>
			<br>
			<input type="text" name="inpPay">
	
        </div>

      </div>
      
    </div>
  </div>

<div class="tablo">{{tablo}}</div>

    <div class="col-sm-4">
		
		<div id="js-flip-1" class="flip">
		    <div class="card" v-bind:class="{flipped:flippedCard0}">
		        <div class="face front" v-on:click="card0"></div>
		        <div class="face back none" v-bind:class="{ yeah: trueClass }">{{resultBox}}</div>
		    </div>
		</div>

    </div>
    <div class="col-sm-4">

		<div id="js-flip-2" class="flip">
		    <div class="card" v-bind:class="{flipped:flippedCard1}">
		        <div class="face front" v-on:click="card1"></div>
		        <div class="face back none" v-bind:class="{ yeah: trueClass }">{{resultBox}}</div>
		    </div>
		</div>

    </div>
    <div class="col-sm-4">
     	
		<div id="js-flip-3" class="flip">
		    <div class="card" v-bind:class="{flipped:flippedCard2}">
		        <div class="face front" v-on:click="card2"></div>
		        <div class="face back none" v-bind:class="{ yeah: trueClass }">{{resultBox}}</div>
		    </div>
		</div>
    </div>

     <button type="button" class="btn btn-success" data-toggle="modal" data-target="#myModal">Place a bet</button>
     <button type="button" class="btn btn-warning" v-on:click="freePlay">Free play</button>
     <hr>
     <br><p> Copiright 2013-2019 <br>
	     	bring-Home corp.
	</p>
  </div>


		<div class="progress" v-bind:style="{ display: hideProgressbar }">
		    <div class="progress-bar" role="progressbar" aria-valuenow="12" aria-valuemin="0" aria-valuemax="100" 
		    v-bind:style="{ width: progressbar +'%'}">
		     
		    </div>
		</div>


</div>
<script>

 var socket = io();
	
const vue = new Vue({
	el: '.container',
	data: {
	    progressbar: '',
	    rowDisplay: 'none',
	    hideProgressbar: '',

	    resultBox: '',
	    tablo: '',
	    flippedCard0: false,
	    flippedCard1: false,
	    flippedCard2: false,

	    trueClass: false,
	},
	methods: { 
		card0: function(){
			
				if ( this.flippedCard1 || this.flippedCard2 ) {
					console.log('fuck u!')
				} else {
					this.flippedCard0 = true;	
					socket.emit('click', 0);
				}	
			aa(0)

		},
		card1: function(){
			
				if ( this.flippedCard0 || this.flippedCard2 ) {
					console.log('fuck u!')
				} else {
					this.flippedCard1 = true;
					socket.emit('click', 1);
				}

			aa(1)

		},
		card2: function(){
			
				if ( this.flippedCard0 || this.flippedCard1 ) {
					console.log('fuck u!')
				} else {
					this.flippedCard2 = true;
					socket.emit('click', 2);
				}

			aa(2)

		},
		freePlay: function(){
			this.flippedCard0 = false;
			this.flippedCard1 = false;
			this.flippedCard2 = false;
			setTimeout(function(){
				this.trueClass = false;
			},300 );
		}
	}, 
})

function aa(i){
	socket.on('result', function sock(msg){

		if ( msg == true ){
			console.log( true )
			vue.trueClass = true;
			vue.resultBox = 'You WIN!  +33%'
		} else {
			console.log( false )
			vue.resultBox = 'You LOST!  -25%'
			vue.trueClass = false;

		}
		
	})

}
	function progressbarFun() {
			var loader;
			for( loader = 1; loader < 101; loader++ ){
				setTimeout(function(){
					vue.progressbar = loader;
					if (vue.progressbar === 101){
						//console.log(loader);
						setTimeout(function(){
							vue.rowDisplay = 'block';
							vue.hideProgressbar = 'none';
						},600 );
					}
			},5 );
		}
	}
	progressbarFun()

	$.getJSON('http://ipinfo.io', function(data){
    console.log(data.ip);
});

</script>
</body>
</html>